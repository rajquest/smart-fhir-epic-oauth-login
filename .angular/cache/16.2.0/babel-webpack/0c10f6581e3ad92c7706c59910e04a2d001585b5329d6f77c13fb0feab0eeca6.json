{"ast":null,"code":"(function () {\n  var utils = require(\"../utils\");\n  var id = function (x) {\n    return x;\n  };\n  var constantly = function (x) {\n    return function () {\n      return x;\n    };\n  };\n  var mwComposition = function (mw1, mw2) {\n    return function (h) {\n      return mw1(mw2(h));\n    };\n  };\n  var Middleware = function (mw) {\n    mw.and = function (nmw) {\n      return Middleware(mwComposition(mw, nmw));\n    };\n    mw.end = function (h) {\n      return mw(h);\n    };\n    return mw;\n  };\n\n  // generate wm from function\n  exports.$$Simple = function (f) {\n    return function (h) {\n      return function (args) {\n        return h(f(args));\n      };\n    };\n  };\n  var setAttr = function (args, attr, value) {\n    var path = attr.split('.');\n    var obj = args;\n    for (var i = 0; i < path.length - 1; i++) {\n      var k = path[i];\n      obj = args[k];\n      if (!obj) {\n        obj = {};\n        args[k] = obj;\n      }\n    }\n    obj[path[path.length - 1]] = value;\n    return args;\n  };\n\n  // generate wm from function\n  exports.$$Attr = function (attr, fn) {\n    return Middleware(function (h) {\n      return function (args) {\n        var value = null;\n        if (utils.type(fn) == 'function') {\n          value = fn(args);\n        } else {\n          value = fn;\n        }\n        if (value == null && value == undefined) {\n          return h(args);\n        } else {\n          return h(setAttr(args, attr, value));\n        }\n      };\n    });\n  };\n  var Attribute = function (attr, fn) {\n    return Middleware(function (h) {\n      return function (args) {\n        args[attr] = fn(args);\n        return h(args);\n      };\n    });\n  };\n  var Method = function (method) {\n    return Attribute('method', constantly(method));\n  };\n  exports.Middleware = Middleware;\n  exports.Attribute = Attribute;\n  exports.Method = Method;\n}).call(this);","map":null,"metadata":{},"sourceType":"script","externalDependencies":[]}